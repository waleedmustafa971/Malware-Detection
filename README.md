# Malware-Detection-Utility
# Overview:
This utility is a basic malware detection tool written in C++. It checks for the presence of suspicious processes and registry keys on a Windows system that may indicate the presence of malware, specifically the Emotet trojan. The program scans running processes and common registry paths for signs of malicious activity.
# Features:
1- Process Monitoring: Detects specific suspicious processes such as emotet.exe, cmd.exe, and powershell.exe.
2- Registry Monitoring: Checks for known persistence techniques used by malware, specifically within the Windows registry.

# Prerequisites
1- Operating System: Windows
2- Compiler: Visual Studio or any other C++ compiler that supports Windows API functions.
3- Libraries: Windows API headers (<windows.h>, <tlhelp32.h>, and <winreg.h>).

# Installation

1- Clone the Repository.
2- Compile the Code:
- Open the project in your preferred IDE or use the command line.
- Ensure that the necessary Windows API headers are included in your project.
- Compile the project.

 3-  Run the Executable:

- Once compiled, run the generated executable file.
- The program will output whether any suspicious processes or registry keys were detected.

  ## Code Explanation

# Includes

<img width="317" alt="image" src="https://github.com/user-attachments/assets/467c7be9-8037-4d81-8fe2-4d24a4f95607">

These headers are essential for interacting with Windows processes, registry, and handling input/output operations.

# Function: checkSuspiciousProcesses()
This function takes a snapshot of the currently running processes using CreateToolhelp32Snapshot() and iterates through them with Process32First() and Process32Next(). It checks if any of the processes match suspicious names (e.g., emotet.exe, cmd.exe, powershell.exe).

Return Value: true if a suspicious process is detected, otherwise false.

# Function: checkSuspiciousRegistryKeys()

This function checks a specific registry path (HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run) for known malicious keys that are often used by malware for persistence (e.g., "Emotet").

Return Value: true if a suspicious registry key is detected, otherwise false.

# Main Function
The main function orchestrates the checks by calling checkSuspiciousProcesses() and checkSuspiciousRegistryKeys(). If any suspicious activity is detected, it outputs a warning.

[int main() {
    bool isMalwareDetected = false;

    // Check for suspicious processes
    isMalwareDetected |= checkSuspiciousProcesses();

    // Check for suspicious registry keys
    isMalwareDetected |= checkSuspiciousRegistryKeys();

    if (isMalwareDetected) {
        std::cout << "Potential Emotet activity detected!" << std::endl;
    } else {
        std::cout << "No suspicious activity detected." << std::endl;
    }

    return 0;
}
]
# Usage
1- Run the Program:
- Execute the compiled program from the command line or by double-clicking the executable file.
2- Output:

- If suspicious processes or registry keys are found, the program will notify you.
- If no suspicious activity is detected, it will indicate that the system appears to be clean.

3- Example:

[Suspicious process detected: emotet.exe
Potential Emotet activity detected!
]

# Limitations
- Specific to Known Threats: The tool only detects predefined processes and registry keys. It's not a comprehensive antivirus solution.
- Windows-Specific: The program uses Windows API calls and will not run on other operating systems.

# Contribution

If you wish to contribute to this project, feel free to fork the repository and submit a pull request. Contributions to expand the detection capabilities or improve the code are welcome.

# License

This project is licensed under the MIT License. See the LICENSE file for details.








  





